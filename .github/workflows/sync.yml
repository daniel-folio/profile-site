# .github/workflows/sync.yml

name: Sync to A Repository & Deploy

on:
  push:
    branches:
      - main # B 저장소의 메인 브랜치

jobs:
  sync-and-deploy:
    runs-on: ubuntu-latest
    steps:
      # 1. B 저장소(소스) 코드를 가져옴
      - name: Checkout B Repo
        uses: actions/checkout@v4

      # 2. A 저장소(대상)로 코드를 Push
      - name: Push to A Repo
        uses: peaceiris/actions-gh-pages@v4
        with:
          deploy_key: ${{ secrets.DEPLOY_KEY_FOR_A }}
          external_repository: daniel-works0001/portfolio
          publish_branch: main
          publish_dir: .
          force_orphan: true

      # 3. A 사이트의 Vercel 배포 훅 트리거
      - name: Trigger Vercel Deploy Hook for A Site
        run: curl -X POST "${{ secrets.VERCEL_DEPLOY_HOOK_A }}"